<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>THÉÂTRES YA BISO</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
<style>
    :root {
        --primary-dark: #141414;
        --secondary-dark: #1E1E1E;
        --text-light: #E5E5E5;
        --text-muted: #888888;
        --accent-red: #E50914;
        --shadow-light: rgba(0, 0, 0, 0.2);
        --shadow-medium: rgba(0, 0, 0, 0.5);
    }

    body {
        font-family: 'Poppins', sans-serif;
        background-color: var(--primary-dark);
        color: var(--text-light);
        margin: 0;
        padding: 0;
        line-height: 1.6;
    }

    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 20px 0;
        position: sticky;
        top: 0;
        z-index: 1000;
        background-color: var(--primary-dark);
    }

    .header h1 {
        margin: 0;
        font-size: 1.5em;
        letter-spacing: 1px;
    }

    .header .user-profile {
        font-size: 1.5em;
        color: var(--text-light);
    }

    .categories-nav {
        display: flex;
        justify-content: flex-start;
        padding: 10px 20px;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        -ms-overflow-style: none;
    }

    .categories-nav::-webkit-scrollbar {
        display: none;
    }

    .categories-nav button {
        background: none;
        border: none;
        color: var(--text-muted);
        font-weight: 600;
        font-size: 1em;
        padding: 10px 15px;
        cursor: pointer;
        transition: color 0.3s ease;
        white-space: nowrap;
    }

    .categories-nav button.active {
        color: var(--text-light);
    }

    .categories-nav button:hover {
        color: var(--text-light);
    }

    .hero-section {
        position: relative;
        height: 400px;
        display: flex;
        align-items: flex-end;
        margin: 0 20px 20px;
        overflow: hidden;
        border-radius: 10px;
    }

    .hero-carousel {
        display: flex;
        width: 100%;
        height: 100%;
        transition: transform 0.5s ease-in-out;
    }

    .hero-item {
        min-width: 100%;
        position: relative;
    }

    .hero-item img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        position: absolute;
        top: 0;
        left: 0;
    }

    .hero-content {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        padding: 20px;
        background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
    }

    .hero-content h2 {
        margin: 0 0 10px;
        font-size: 2.5em;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
    }

    .hero-buttons {
        display: flex;
        gap: 15px;
    }

    .hero-buttons button {
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        font-size: 1em;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s ease;
    }

    .hero-buttons button:hover {
        transform: scale(1.05);
    }

    .hero-buttons .play-btn {
        background-color: var(--text-light);
        color: var(--primary-dark);
    }

    .hero-buttons .add-btn {
        background-color: var(--text-muted);
        color: var(--text-light);
    }

    .content-row {
        padding: 0 0 20px 20px;
    }

    .content-row h2 {
        font-size: 1.4em;
        margin-bottom: 15px;
    }

    /* Accueil : ligne horizontale */
    .content-row.home .videos-list {
        display: flex;
        overflow-x: scroll;
        gap: 15px;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        -ms-overflow-style: none;
    }

    .content-row.home .videos-list::-webkit-scrollbar {
        display: none;
    }

    /* Catégories : grille 2 colonnes */
    .content-row.category .videos-list {
        display: grid;
        grid-template-columns: repeat(2, 150px);
        grid-auto-rows: 225px;
        grid-gap: 15px;
        max-height: 900px;
        overflow-y: auto;
        padding-right: 10px;
    }

    .home-video-card {
        width: 250px;
        height: 140.625px;
        background-color: var(--secondary-dark);
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 10px var(--shadow-light);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        cursor: pointer;
        flex-shrink: 0;
    }

    .home-video-card:hover {
        transform: scale(1.05);
        box-shadow: 0 8px 16px var(--shadow-medium);
    }

    .home-video-card img.video-thumbnail {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }

    .video-card-vertical {
        width: 150px;
        height: 225px;
        background-color: var(--secondary-dark);
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 10px var(--shadow-light);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        cursor: pointer;
    }

    .video-card-vertical:hover {
        transform: scale(1.05);
        box-shadow: 0 8px 16px var(--shadow-medium);
    }

    .video-card-vertical img.video-thumbnail {
        height: 100%;
        width: auto;
        object-fit: cover;
        margin-left: auto;
        margin-right: auto;
        display: block;
    }

    #video-player-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.95);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        animation: fadeIn 0.3s ease-out forwards;
    }

    #video-player {
        width: 90%;
        max-width: 1000px;
        height: 70%;
        max-height: 600px;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0,0,0,0.5);
    }

    #close-btn {
        position: absolute;
        top: 25px;
        right: 35px;
        color: var(--text-light);
        font-size: 45px;
        cursor: pointer;
        transition: transform 0.2s ease;
        text-shadow: 2px 2px 5px var(--shadow-medium);
    }

    #close-btn:hover {
        transform: rotate(90deg) scale(1.1);
    }

    .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background-color: var(--secondary-dark);
        display: flex;
        justify-content: space-around;
        padding: 10px 0;
        border-top: 1px solid #333;
        z-index: 999;
    }

    .nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        color: var(--text-muted);
        text-decoration: none;
        font-size: 0.8em;
        transition: color 0.3s ease;
    }

    .nav-item i {
        font-size: 1.2em;
        margin-bottom: 5px;
    }

    .nav-item.active {
        color: var(--text-light);
    }
</style>
</head>
<body>

<header class="header">
    <h1>THÉÂTRES YA BISO<br /><small style="font-size:0.5em; color:var(--text-muted);">mboka_mj</small></h1>
    <div class="user-profile" aria-label="recherche et profil">
        <i class="fas fa-search" role="button" tabindex="0" aria-label="Recherche"></i>
        <i class="fas fa-user-circle" role="button" tabindex="0" aria-label="Profil utilisateur"></i>
    </div>
</header>

<main>
    <section class="hero-section" aria-label="Carrousel vidéo tendance">
        <div class="hero-carousel"></div>
    </section>

    <nav class="categories-nav" role="navigation" aria-label="Navigation par catégories">
        <button onclick="loadCategory('Accueil')" class="active" aria-current="page">Accueil</button>
        <button onclick="loadCategory('Tendance')">Tendance</button>
        <button onclick="loadCategory('Gag')">Gag</button>
        <button onclick="loadCategory('Films')">Films Congolais</button>
        <button onclick="loadCategory('Musique')">Musique</button>
    </nav>

    <section id="content-rows" aria-live="polite"></section>
</main>

<div id="video-player-container" role="dialog" aria-modal="true" aria-labelledby="video-title">
    <iframe id="video-player" width="100%" height="auto" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen title="Lecteur vidéo"></iframe>
    <span id="close-btn" role="button" tabindex="0" aria-label="Fermer la lecture vidéo">✖</span>
</div>

<nav class="bottom-nav" role="navigation" aria-label="Navigation inférieure">
    <a href="#" class="nav-item active" aria-current="page">
        <i class="fas fa-home"></i>
        <span>Accueil</span>
    </a>
    <a href="#" class="nav-item" tabindex="0">
        <i class="fas fa-trophy"></i>
        <span>Classement</span>
    </a>
    <a href="#" class="nav-item" tabindex="0">
        <i class="fas fa-bell"></i>
        <span>Nouveautés</span>
    </a>
    <a href="#" class="nav-item" tabindex="0">
        <i class="fas fa-download"></i>
        <span>Télécharger</span>
    </a>
</nav>

<script>
    const API_KEY = 'AIzaSyCsfwTS61H_NOb0U2aK2TC3LLnB4vnfTNM';

    const contentRowsContainer = document.getElementById('content-rows');
    const categoriesNavButtons = document.querySelectorAll('.categories-nav button');
    const videoPlayerContainer = document.getElementById('video-player-container');
    const videoPlayer = document.getElementById('video-player');
    const closeBtn = document.getElementById('close-btn');
    const heroCarousel = document.querySelector('.hero-carousel');
    const heroSection = document.querySelector('.hero-section');

    const playlists = {
        'Tendance': 'PL_0_czPdB1wTMgJ6mr3mtUPSoTeTjUBdg',
        'Gag': 'PL_0_czPdB1wQC-n2pfKZPgv0Qw5M5cTnJ',
        'Films': 'PL_0_czPdB1wTgFfbOMYbCz5fX6gzFJjPq',
        'Musique': 'PL_0_czPdB1wRQvWg-2NFZebqSGbcCtmvW',
    };

    const allVideos = {};
    let carouselVideos = [];

    async function fetchVideos(playlistId) {
        if (allVideos[playlistId]) return allVideos[playlistId];
        try {
            const res = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=20&playlistId=${playlistId}&key=${API_KEY}`);
            if (!res.ok) {
                const errData = await res.json();
                throw new Error(`Erreur API (${res.status}): ${errData.error.message || res.statusText}`);
            }
            const data = await res.json();
            const videos = data.items.filter(item => item.snippet && item.snippet.thumbnails && item.snippet.thumbnails.high && item.snippet.title !== "Private video" && item.snippet.title !== "Deleted video");
            allVideos[playlistId] = videos;
            return videos;
        } catch (error) {
            console.error("Erreur lors de la récupération des vidéos:", error);
            alert("Impossible de charger les vidéos. Veuillez vérifier votre clé API ou connexion. Détails: " + error.message);
            return [];
        }
    }

    function renderVideos(videos, title, isHome = false) {
        const rowSection = document.createElement('section');
        rowSection.className = 'content-row ' + (isHome ? 'home' : 'category');
        rowSection.innerHTML = `<h2>${title}</h2><div class="videos-list"></div>`;
        const videoList = rowSection.querySelector('.videos-list');

        videos.forEach(item => {
            const snippet = item.snippet;
            const videoId = snippet.resourceId.videoId;
            const card = document.createElement('div');

            if (isHome) {
                card.className = 'video-card home-video-card';
            } else {
                card.className = 'video-card video-card-vertical';
            }

            card.innerHTML = `<img src="${snippet.thumbnails.high.url}" alt="${snippet.title}" class="video-thumbnail" loading="lazy" />`;
            card.onclick = () => {
                videoPlayer.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
                videoPlayerContainer.style.display = 'flex';
                videoPlayer.focus();
            };
            videoList.appendChild(card);
        });

        contentRowsContainer.appendChild(rowSection);
    }

    async function loadHome() {
        contentRowsContainer.innerHTML = '';
        const allCategories = Object.keys(playlists);
        for (const category of allCategories) {
            const videos = await fetchVideos(playlists[category]);
            const limitedVideos = videos.slice(0, 5);
            if (limitedVideos.length > 0) renderVideos(limitedVideos, category, true);
        }
    }

    async function loadCategory(categoryName) {
        categoriesNavButtons.forEach(button => {
            button.classList.remove('active');
            if (button.textContent.trim() === categoryName) button.classList.add('active');
        });
        contentRowsContainer.innerHTML = '';
        if (categoryName === 'Accueil') {
            await loadHome();
        } else if (playlists[categoryName]) {
            const videos = await fetchVideos(playlists[categoryName]);
            renderVideos(videos, categoryName);
        }
    }

    async function setupHeroCarousel() {
        const tendanceVideos = await fetchVideos(playlists['Tendance']);
        carouselVideos = tendanceVideos.slice(0, 5);
        heroCarousel.innerHTML = '';
        if (carouselVideos.length === 0) {
            heroSection.style.display = 'none';
            return;
        } else {
            heroSection.style.display = 'flex';
        }

        carouselVideos.forEach(item => {
            const snippet = item.snippet;
            const videoId = snippet.resourceId.videoId;
            const heroItem = document.createElement('div');
            heroItem.className = 'hero-item';
            heroItem.innerHTML = `
                <img src="${snippet.thumbnails.maxres ? snippet.thumbnails.maxres.url : snippet.thumbnails.high.url}" alt="${snippet.title}" />
                <div class="hero-content">
                    <h2>${snippet.title}</h2>
                    <div class="hero-buttons">
                        <button class="play-btn" onclick="playVideo('${videoId}')"><i class="fas fa-play"></i> Lecture</button>
                        <button class="add-btn" title="Ajouter à ma liste"><i class="fas fa-plus"></i> Ma liste</button>
                    </div>
                </div>
            `;
            heroCarousel.appendChild(heroItem);
        });

        let currentSlide = 0;
        const totalSlides = carouselVideos.length;

        const updateCarousel = () => {
            const offset = -currentSlide * heroSection.offsetWidth;
            heroCarousel.style.transform = `translateX(${offset}px)`;
        };

        setInterval(() => {
            currentSlide = (currentSlide + 1) % totalSlides;
            updateCarousel();
        }, 5000);

        window.addEventListener('resize', updateCarousel);
    }

    function playVideo(videoId) {
        videoPlayer.src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
        videoPlayerContainer.style.display = 'flex';
        videoPlayer.focus();
    }

    closeBtn.onclick = () => {
        videoPlayerContainer.style.display = 'none';
        videoPlayer.src = '';
    };

    closeBtn.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            closeBtn.click();
        }
    });

    document.addEventListener('DOMContentLoaded', () => {
        setupHeroCarousel();
        loadCategory('Accueil');
    });
</script>

</body>
</html>
